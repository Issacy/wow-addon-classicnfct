* fix layout in some case and optimize performance